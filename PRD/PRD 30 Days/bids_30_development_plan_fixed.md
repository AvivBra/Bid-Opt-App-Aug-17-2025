# תוכנית פיתוח - Bids 30 Days Optimization
**תאריך: 17/08/2025 12:40**

## שלב 1: תשתית בסיסית
**מטרה:** יצירת השלד הבסיסי והגדרת האופטימיזציה החדשה במערכת.

### קבצים לכתיבה/עדכון:
- `business/bid_optimizations/bids_30_days/__init__.py`
- `business/bid_optimizations/bids_30_days/orchestrator.py`
- `business/bid_optimizations/bids_30_days/constants.py`
- `config/optimization_config.py`

### מה תראי בסוף השלב:
- תיקייה חדשה `bids_30_days` בעץ הקבצים
- הגדרות קונפיגורציה חדשות (אבל עדיין לא פעילות בממשק)

**תוצאה רצויה:** המערכת מכירה את האופטימיזציה החדשה אך היא עדיין לא זמינה למשתמש.

---

## שלב 2: ולידציה
**מטרה:** הגדרת כללי הבדיקה לוודא שהנתונים מתאימים לעיבוד 30 Days.

### קבצים לכתיבה:
- `business/bid_optimizations/bids_30_days/validator.py`

### מה תראי בסוף השלב:
- אין שינוי ויזואלי (לוגיקה פנימית בלבד)

**תוצאה רצויה:** המערכת יודעת לבדוק אם הנתונים תקינים לפני תחילת העיבוד.

---

## שלב 3: ניקוי נתונים
**מטרה:** סינון השורות הרלוונטיות והסרת נתונים לא תקינים או מוחרגים.

### קבצים לכתיבה:
- `business/bid_optimizations/bids_30_days/cleaner.py`

### מה תראי בסוף השלב:
- אין שינוי ויזואלי (לוגיקה פנימית בלבד)

**תוצאה רצויה:** רק שורות העומדות בתנאי הסינון (units > 0 ותנאים נוספים) יעברו לעיבוד.

---

## שלב 4: עיבוד חישובים
**מטרה:** מימוש הלוגיקה העסקית המלאה של חישוב Bid חדש לפי 7 השלבים.

### קבצים לכתיבה:
- `business/bid_optimizations/bids_30_days/processor.py`

### מה תראי בסוף השלב:
- אין שינוי ויזואלי (לוגיקה פנימית בלבד)

**תוצאה רצויה:** המערכת מחשבת Bid חדש לכל שורה וכן יוצרת גיליון "For Harvesting" לשורות ללא Target CPA.

---

## שלב 5: ממשק משתמש
**מטרה:** הוספת האופטימיזציה לממשק המשתמש והפעלת כפתור Bulk 30.

### קבצים לעדכון:
- `app/ui/components/checklist.py`
- `app/ui/shared/upload_section.py`

### מה תראי בסוף השלב:
- ✅ Checkbox חדש "Bids 30 Days" ברשימת האופטימיזציות
- ✅ כפתור "Upload Bulk 30" הופך לפעיל אחרי שבוחרים בצ'קבוקס Bids 30 Days (במקום "Coming Soon")
- ✅ הודעות ולידציה מותאמות ל-30 Days
- ✅ בחירת checkbox מפעילה/משביתה כפתורי העלאה מתאימים

**תוצאה רצויה:** המשתמש יכול לבחור את האופטימיזציה החדשה ולהעלות קובץ Bulk 30.

---

## שלב 6: ניהול מצב
**מטרה:** שמירת נתוני Bulk 30 במצב הסשן לשימוש בעיבוד.

### קבצים לעדכון:
- `app/state/bid_state.py`

### מה תראי בסוף השלב:
- ✅ שמירת קובץ Bulk 30 במצב הסשן
- ✅ הודעת אישור "Bulk 30 uploaded successfully" אחרי העלאה

**תוצאה רצויה:** המערכת זוכרת את הקובץ שהועלה ומוכנה לעבד אותו.

---

## שלב 7: פורמט פלט
**מטרה:** הכנת הפלט עם הגיליונות החדשים וסימון השורות הבעייתיות.

### קבצים לכתיבה:
- `business/bid_optimizations/bids_30_days/output_formatter_30_days.py`

### מה תראי בסוף השלב:
- אין שינוי ויזואלי (הכנה לפלט בלבד)

**תוצאה רצויה:** המערכת יודעת לפרמט את התוצאות כולל גיליון "For Harvesting" וצביעת שורות.

---

## שלב 8: אינטגרציה ראשית
**מטרה:** חיבור כל החלקים והפעלת האופטימיזציה המלאה מקצה לקצה.

### קבצים לעדכון:
- `app/pages/bid_optimizer.py`

### מה תראי בסוף השלב:
- ✅ עיבוד מלא כשבוחרים "Bids 30 Days" ולוחצים "Process Files"
- ✅ גיליון נוסף "For Harvesting" בקובץ הפלט
- ✅ שורות מסומנות בוורוד (CVR < 8%, שגיאות, Bid מחוץ לטווח)
- ✅ הודעות סטטוס: "[X] rows with CVR < 8%", "[Y] errored rows"
- ✅ 10 עמודות עזר חדשות (calc3, Temp Bid, Max_Bid וכו')
- ✅ כותרות עמודות בתכלת לעמודות משתתפות בעיבוד

**תוצאה רצויה:** אופטימיזציית Bids 30 Days עובדת במלואה ומייצרת קובץ Excel עם כל התוצאות הנדרשות.