# תרחישי בדיקה - Bid Optimizer

## תרחישי Happy Path

### תרחיש 1: תהליך מלא מוצלח

**תיאור:** משתמש מעלה קבצים תקינים ומבצע אופטימיזציה

**צעדים:**
1. פתיחת האפליקציה
2. סימון checkbox של Zero Sales
3. העלאת Template תקין עם 5 פורטפוליוז
4. העלאת Bulk 60 תקין עם 10,000 שורות
5. המתנה לוולידציה - "All portfolios valid"
6. לחיצה על Process Files
7. המתנה לסיום העיבוד
8. הורדת Working File

**תוצאה צפויה:**
• וולידציה עוברת בהצלחה
• Progress bar מתקדם חלק
• קובץ Working File עם 2 לשוניות
• עמודות עזר נוספו ל-Targeting
• שורות עם Units=0 עודכנו

### תרחיש 2: עבודה עם פורטפוליוז Ignore

**תיאור:** חלק מהפורטפוליוז מסומנים כ-Ignore

**צעדים:**
1. העלאת Template עם 3 פורטפוליוז רגילים ו-2 עם "Ignore"
2. העלאת Bulk 60
3. בדיקת הודעת אזהרה על Ignore
4. המשך לעיבוד

**תוצאה צפויה:**
• הודעה: "2 portfolios marked as Ignore"
• רק 3 פורטפוליוז מעובדים
• שורות של Ignore portfolios לא משתנות

### תרחיש 3: עבודה עם Flat Portfolios

**תיאור:** ב-Bulk יש Flat portfolios שאינם ב-Template

**צעדים:**
1. העלאת Template ללא Flat portfolios
2. העלאת Bulk עם "Flat 30", "Flat 25 | Opt"
3. בדיקה שאין שגיאה על חוסר

**תוצאה צפויה:**
• וולידציה עוברת בהצלחה
• Flat portfolios מסוננים אוטומטית
• אין דרישה להוסיף אותם ל-Template

## תרחישי שגיאה

### תרחיש 4: חסרים פורטפוליוז

**תיאור:** פורטפוליוז מ-Bulk חסרים ב-Template

**צעדים:**
1. העלאת Template עם 3 פורטפוליוז
2. העלאת Bulk עם 5 פורטפוליוז (2 חסרים)
3. קבלת הודעת שגיאה
4. העלאת Template מתוקן
5. המשך לעיבוד

**תוצאה צפויה:**
• הודעה: "Missing portfolios found"
• רשימת הפורטפוליוז החסרים
• כפתור Upload New Template
• Bulk נשמר בזיכרון
• אחרי תיקון - וולידציה עוברת

### תרחיש 5: כל הפורטפוליוז ב-Ignore

**תיאור:** כל הפורטפוליוז ב-Template מסומנים כ-Ignore

**צעדים:**
1. העלאת Template עם Base Bid = "Ignore" לכולם
2. העלאת Bulk
3. קבלת הודעת שגיאה

**תוצאה צפויה:**
• הודעה: "All portfolios marked as Ignore"
• אין אפשרות להמשיך לעיבוד
• צריך להעלות Template חדש

### תרחיש 6: קובץ גדול מדי

**תיאור:** ניסיון להעלות קובץ מעל המגבלה

**צעדים:**
1. ניסיון להעלות Bulk של 50MB
2. קבלת הודעת שגיאה

**תוצאה צפויה:**
• הודעה: "File exceeds 40MB limit"
• הקובץ לא נטען
• צריך קובץ קטן יותר

### תרחיש 7: מבנה Template שגוי

**תיאור:** Template חסרה לשונית או עמודות

**צעדים:**
1. העלאת Template עם לשונית אחת בלבד
2. קבלת הודעת שגיאה

**תוצאה צפויה:**
• הודעה: "Missing 'Port Values' sheet"
• הקובץ לא נטען
• צריך Template תקין

## תרחישי מקרי קצה

### תרחיש 8: אין שורות עם Units=0

**תיאור:** בכל הנתונים אין מוצרים ללא מכירות

**צעדים:**
1. העלאת קבצים תקינים
2. כל השורות עם Units > 0
3. ניסיון עיבוד

**תוצאה צפויה:**
• הודעה: "No rows with Units=0 found"
• אין מה לעבד
• קובץ פלט ריק או הודעת אזהרה

### תרחיש 9: Portfolio Names עם תווים מיוחדים

**תיאור:** שמות פורטפוליוז עם תווים מיוחדים

**צעדים:**
1. Template עם "Portfolio#1", "Portfolio/2"
2. Bulk עם אותם שמות
3. עיבוד

**תוצאה צפויה:**
• המערכת מטפלת נכון
• Case Sensitive matching
• אין בעיה עם תווים מיוחדים

### תרחיש 10: ערכי Bid מחוץ לטווח

**תיאור:** חישובים שיוצרים Bid לא תקין

**צעדים:**
1. העלאת נתונים שיגרמו ל-Bid < 0.02
2. עיבוד
3. בדיקת הפלט

**תוצאה צפויה:**
• השורות מסומנות בורוד ב-Excel
• הודעה ב-UI: "234 calculation errors found"
• אין הודעה ורודה ב-UI

## תרחישי ביצועים

### תרחיש 11: קובץ מקסימלי

**תיאור:** עיבוד 500,000 שורות

**צעדים:**
1. העלאת Bulk עם 500,000 שורות
2. עיבוד

**תוצאה צפויה:**
• עיבוד מסתיים תוך 120 שניות
• Progress bar מתעדכן
• אין קריסה או תקיעה

### תרחיש 12: מספר רב של פורטפוליוז

**תיאור:** Template עם 1,000 פורטפוליוז

**צעדים:**
1. העלאת Template עם 1,000 פורטפוליוז
2. Bulk עם נתונים לכולם
3. עיבוד

**תוצאה צפויה:**
• המערכת מטפלת ללא בעיה
• זמן עיבוד סביר
• כל הפורטפוליוז מעובדים

## תרחישי UI

### תרחיש 13: ניווט בין עמודים

**תיאור:** מעבר Sidebar בזמן עיבוד

**צעדים:**
1. התחלת עיבוד
2. ניסיון ללחוץ על Campaigns Optimizer

**תוצאה צפויה:**
• Campaigns Optimizer מושבת
• אין אפשרות לעבור
• העיבוד ממשיך

### תרחיש 14: רענון דף

**תיאור:** רענון הדפדפן באמצע

**צעדים:**
1. העלאת קבצים
2. F5 לרענון
3. בדיקת המצב

**תוצאה צפויה:**
• הנתונים נשמרים ב-Session State
• אפשר להמשיך מאותה נקודה
• רק Reset מנקה הכל

### תרחיש 15: הורדות מרובות

**תיאור:** הורדת הקובץ כמה פעמים

**צעדים:**
1. סיום עיבוד
2. הורדת Working File
3. הורדה שוב
4. שינוי שם והורדה

**תוצאה צפויה:**
• אפשר להוריד כמה פעמים
• שם הקובץ עם timestamp מתעדכן
• הקובץ נשמר בזיכרון עד Reset

## תרחישי התאוששות

### תרחיש 16: Timeout בעיבוד

**תיאור:** עיבוד שלוקח יותר מ-5 דקות

**צעדים:**
1. העלאת קובץ ענק או בעייתי
2. המתנה 5 דקות

**תוצאה צפויה:**
• הודעת Timeout
• אפשרות Retry או Reset
• המערכת לא קורסת

### תרחיש 17: שגיאת זיכרון

**תיאור:** חריגה ממגבלת הזיכרון

**צעדים:**
1. ניסיון לעבד קובץ ענק
2. קבלת שגיאת זיכרון

**תוצאה צפויה:**
• הודעה: "Out of memory"
• המלצה לקובץ קטן יותר
• אפשרות Reset

## תרחישי אינטגרציה

### תרחיש 18: פתיחת קובץ ב-Excel

**תיאור:** פתיחת Working File שהורד

**צעדים:**
1. הורדת Working File
2. פתיחה ב-Excel
3. בדיקת התוכן

**תוצאה צפויה:**
• 2 לשוניות: Targeting, Bidding Adjustment
• 7 עמודות עזר ב-Targeting
• שורות ורודות נראות נכון
• Operation = "Update" בכל השורות

### תרחיש 19: העלאה ל-Amazon

**תיאור:** העלאת הקובץ המעובד ל-Amazon

**צעדים:**
1. לקיחת Working File
2. מחיקת עמודות עזר ידנית
3. העלאה ל-Amazon

**תוצאה צפויה:**
• Amazon מקבל את הקובץ
• העדכונים מתבצעים
• Bids משתנים בהתאם

## תרחישי נגישות

### תרחיש 20: ניגודיות צבעים

**תיאור:** בדיקת קריאות בתאורות שונות

**צעדים:**
1. בדיקה בתאורה חזקה
2. בדיקה בתאורה חלשה
3. בדיקת טקסט על רקעים שונים

**תוצאה צפויה:**
• טקסט #E5E5E5 על #0A0A0A קריא
• טקסט #E5E5E5 על #171717 קריא
• נקודות צבעוניות בולטות
• הודעות על #404040 קריאות

## תרחישי בדיקות רגרסיה

### תרחיש 21: אחרי הוספת אופטימיזציה חדשה

**תיאור:** וידוא ש-Zero Sales עובד אחרי הוספת אופטימיזציות

**צעדים:**
1. הוספת אופטימיזציה חדשה (עתידי)
2. בדיקת Zero Sales
3. וידוא שאין השפעה

**תוצאה צפויה:**
• Zero Sales עובד כרגיל
• אין תלות בין אופטימיזציות
• כל אחת עצמאית

### תרחיש 22: שינוי גרסת Python/Streamlit

**תיאור:** בדיקה אחרי עדכון סביבה

**צעדים:**
1. עדכון Python או Streamlit
2. הרצת כל התרחישים
3. השוואת תוצאות

**תוצאה צפויה:**
• הכל עובד כמו קודם
• אין שינויים בחישובים
• UI נראה אותו דבר

## קריטריוני Pass/Fail

### תרחיש עובר אם:
• כל הצעדים מתבצעים ללא שגיאה
• התוצאות תואמות את הצפוי
• זמני תגובה בתוך המגבלות
• אין קריסות או תקיעות

### תרחיש נכשל אם:
• שגיאה לא צפויה
• תוצאה שונה מהצפוי
• חריגה מזמני תגובה
• קריסת המערכת

## סדר עדיפויות בדיקה

### Priority 1 - קריטי
• תרחיש 1: תהליך מלא
• תרחיש 4: חסרים פורטפוליוז
• תרחיש 11: קובץ מקסימלי
• תרחיש 18: פתיחה ב-Excel

### Priority 2 - חשוב
• תרחיש 2: Ignore portfolios
• תרחיש 3: Flat portfolios
• תרחיש 10: Bid מחוץ לטווח
• תרחיש 16: Timeout

### Priority 3 - רגיל
• תרחיש 8: אין Units=0
• תרחיש 14: רענון דף
• תרחיש 15: הורדות מרובות
• תרחיש 20: ניגודיות

## מטריצת כיסוי

### פונקציונליות מכוסה:
• העלאת קבצים: תרחישים 1, 4, 6, 7
• וולידציה: תרחישים 1, 4, 5, 7
• עיבוד: תרחישים 1, 2, 3, 10
• הורדה: תרחישים 1, 15, 18
• שגיאות: תרחישים 4, 5, 6, 16, 17
• ביצועים: תרחישים 11, 12

### פונקציונליות TBC (לא נבדקת):
• 13 אופטימיזציות נוספות
• Campaigns Optimizer
• Clean File
• Data Rova
• Bulk 7/30

## הערות למבצע הבדיקות

• בדוק תמיד Case Sensitivity בשמות
• וודא ש-10 ה-Flat Portfolios מסוננים
• בדוק שאין הודעה ורודה ב-UI
• וודא צביעה ורודה רק ב-Excel
• בדוק Operation = "Update" בפלט