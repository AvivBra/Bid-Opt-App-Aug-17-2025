# מפרט מיזוג תוצאות - Portfolio Optimizer
## תאריך: 30 באוגוסט 2025 | שעה: 16:40

---

## 1. עיקרון המיזוג
1. המערכת מיישמת בנפרד כל אופטימזציה ושומרת זכרון את הפצ׳ים הנפרדים ברמת התא. 
2. בגמר בניית הפאצ׳ים הנפרדים המערכת מדביקה פאצ׳ של אופטימזציה ראשונה על הנתונים המקוריים - זה אמור לשנות רק תאים ספציפיים שהשתנו באופטימזציה הראשונה ולא לשנות את השאר. 
3. אח״כ המערכת עוברת להדבקת הפאצ׳ים שבוצעו באופטימזציה הבאה בתור על התוצר של ההדבקה הקודמת
התוצאה הסופית היא - רק תאים שעברו שינוי באחת הטרנספורמציות - התוכן שלהם שונה מהתוכן המקורי של הקובץ נתונים המקורי
**כל עדכון הוא ברמת תא בודד** - לא שורות שלמות, לא עמודות שלמות.

---

## 2. מבנה הפאץ'
- שם הגיליון
- מספר השורה
- מפתח לזיהוי מספר התא המדויק
- רק התאים שהשתנו וערכיהם החדשים

---

## 3. תהליך המיזוג
1. מצא את השורה לפי המפתח
2. מצא את העמודה שבה חל שינוי לפי המפתח
3. עדכן רק את התאים הספציפיים שבפאץ'
4. תעד את השינוי

---

## 4. טיפול בקונפליקטים
- **אותו תא משתנה פעמיים** → האחרון גובר
- **תאים שונים באותה שורה** → שני השינויים מתבצעים
- **תמיד תעד קונפליקטים בלוג**

---

## 5. עמודות מוגנות
אסור לעדכן:
- Entity
- Campaign ID (בקמפיינים)
- Portfolio ID (בפורטפוליוז)

---

## 6. יתרונות
- אין דריסות מיותרות
- שינויים כירורגיים בלבד
- תיעוד מדויק של כל שינוי

---

## 7. מגבלות
- מקסימום 500,000 עדכוני תאים
- מקסימום 60 שניות למיזוג

---

## 8. החוק המרכזי
**עדכן רק מה שבאמת השתנה, תמיד ברמת התא הבודד.**