# פורמטי קבצי פלט

## סקירה כללית

המערכת מייצרת קבצי פלט בפורמט Excel המוכנים להעלאה חזרה ל-Amazon Ads. כרגע רק Working File פעיל.

## Working File (פעיל)

### מאפיינים כלליים
- **פורמט:** Excel (.xlsx)
- **מספר לשוניות:** 2

### לשונית 1: Targeting

#### מבנה העמודות
- **48 עמודות מקוריות:** כל העמודות מה-Bulk המקורי
- **7 עמודות עזר:** נוספות משמאל לעמודה 28 (Bid)

#### 7 עמודות העזר (בסדר הזה)
1. **Old Bid** - הערך המקורי של Bid
2. **calc1** - חישוב ביניים ראשון
3. **calc2** - חישוב ביניים שני
4. **Target CPA** - ערך מה-Template
5. **Base Bid** - ערך מה-Template
6. **Adj. CPA** - CPA מותאם
7. **Max BA** - ערך Maximum Bidding Adjustment

#### Entity Types בלשונית זו
- Keyword
- Product Targeting

#### שינויים בנתונים
- **Bid (עמודה 28):** מעודכן לפי החישוב
- **Operation (עמודה 3):** תמיד "Update"

### לשונית 2: Bidding Adjustment

#### מבנה העמודות
- **48 עמודות בלבד:** ללא עמודות עזר
- **נתונים:** כמו במקור, ללא שינויים

#### Entity Types בלשונית זו
- Bidding Adjustment
- Product Ad

#### שינויים בנתונים
- **Operation (עמודה 3):** תמיד "Update"

## סימון שורות בעייתיות

### צביעה ורודה ב-Excel
- **מתי:** כשערך Bid מחושב מחוץ לטווח 0.02-1.25
- **איך:** כל התאים בשורה נצבעים בורוד
- **הערך:** נשאר כמו שחושב (לא משתנה)

### הודעה ב-UI
- **טקסט:** "234 calculation errors found (marked in Excel file)"
- **מיקום:** בפאנל הפלט

## Clean File (TBC)

- **סטטוס:** לפיתוח עתידי - לא מיושם ב-Phase 1

## מבנה הנתונים

### סדר השורות
- נשמר כמו בקובץ המקורי
- אין מיון נוסף

### ערכים ריקים
- נשמרים כמו במקור
- NULL נשאר NULL

## תאימות

### Amazon Ads
- **מבנה:** תואם לדרישות Amazon
- **Operation:** תמיד "Update" מאפשר העלאה
- **Entity Types:** תואמים לערכים המקובלים

## הערות חשובות

- **שמירת מקור:** כל הנתונים המקוריים נשמרים
- **עמודות Informational:** לא משתנות לעולם
- **Case Sensitive:** כל הערכים נשמרים במדויק

---

**עדכון אחרון:** 18 באוגוסט 2025, 20:00