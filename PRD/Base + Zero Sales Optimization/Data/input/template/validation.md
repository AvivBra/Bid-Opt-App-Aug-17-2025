# וולידציה של קובץ Template

## סקירה כללית

תהליך הוולידציה בודק את תקינות קובץ ה-Template לפני עיבוד.

## בדיקות מבנה

### בדיקת פורמט קובץ
- **סוג קובץ:** חייב להיות Excel (.xlsx)
- **גודל:** עד 1MB

### בדיקת לשוניות
- **מספר לשוניות:** בדיוק 2
- **שמות לשוניות:** "Port Values" ו-"Top ASINs"

### בדיקת עמודות ב-Port Values
- **מספר עמודות:** בדיוק 3
- **כותרות:** Portfolio Name, Base Bid, Target CPA
- **סדר:** חייב להיות מדויק

## בדיקות נתונים

### Portfolio Name (עמודה A)
- **ייחודיות:** אין כפילויות
- **ערכים ריקים:** אסור
- **אורך:** עד 255 תווים
- **תווים אסורים:** בדיקה ל- /, \, *, ?, <, >, |

### Base Bid (עמודה B)
- **ערכים תקינים:**
  - מספר בטווח 0.02-4.00
  - המילה "Ignore" (Case Sensitive)
- **ערכים ריקים:** אסור
- **פורמט מספר:** עד 2 ספרות אחרי הנקודה
- **טקסט לא תקין:** כל טקסט מלבד "Ignore" = שגיאה

### Target CPA (עמודה C)
- **ערכים תקינים:**
  - מספר בטווח 0.01-9999.99
  - ערך ריק
- **מספרים שליליים:** אסור

## בדיקות לוגיות

### בדיקת Ignore
- **לפחות אחד פעיל:** חייב להיות לפחות portfolio אחד עם Base Bid מספרי
- **כולם Ignore:** אם כל הפורטפוליוז מסומנים "Ignore" = שגיאה

### בדיקת Portfolio Names
- **Case Sensitive:** השוואה מדויקת לאותיות גדולות/קטנות
- **רווחים:** רווחים בהתחלה/סוף נחשבים

## הודעות שגיאה

### שגיאות קריטיות (עוצרות עיבוד)
- "Missing 'Port Values' sheet"
- "Duplicate portfolio names found: [רשימה]"
- "All portfolios marked as Ignore"
- "Invalid column structure in Port Values"
- "Base Bid must be number or 'Ignore'"

### אזהרות (ממשיכות עיבוד)
- "Missing 'Top ASINs' sheet (optional)"
- "X portfolios marked as Ignore"
- "Target CPA missing in Y rows"
- "High Base Bid value: [ערך] > 3.00"

## תהליך הוולידציה

### שלב 1: בדיקת קובץ
1. בדיקת סוג וגודל
2. ניסיון פתיחה
3. ספירת לשוניות

### שלב 2: בדיקת מבנה
1. אימות שמות לשוניות
2. בדיקת עמודות Port Values
3. בדיקת כותרות

### שלב 3: בדיקת נתונים
1. סריקת Portfolio Names
2. בדיקת Base Bid values
3. בדיקת Target CPA values

### שלב 4: בדיקות לוגיות
1. חיפוש כפילויות
2. ספירת Ignore
3. אימות לפחות portfolio אחד פעיל

## סטטיסטיקות וולידציה

המערכת אוספת ומציגה:
- מספר portfolios כולל
- מספר portfolios עם "Ignore"
- מספר portfolios פעילים
- מספר portfolios עם Target CPA
- מספר שגיאות/אזהרות

## טיפול בתוצאות

### אם הוולידציה עברה
- הודעה: "Template validated successfully"
- המשך לשלב הבא

### אם יש שגיאות
- הצגת רשימת שגיאות
- אפשרות להעלות קובץ חדש
- שמירת Bulk בזיכרון (אם הועלה)

---

**עדכון אחרון:** 18 באוגוסט 2025, 20:00