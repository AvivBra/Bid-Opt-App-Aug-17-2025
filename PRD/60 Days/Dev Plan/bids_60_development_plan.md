# תוכנית פיתוח - Bids 60 Days Optimization
**תאריך: 25/12/2024 09:00**

## הערה חשובה - וולידציה
**אין צורך בכתיבה או שינוי של אף קובץ וולידציה. קבצי הוולידציה הגלובליים הקיימים מטפלים בכל הוולידציות הנדרשות.**

---

## שלב 1: תשתית בסיסית
**מטרה:** יצירת השלד הבסיסי והגדרת האופטימיזציה החדשה במערכת.

### קבצים לכתיבה/עדכון:
- `business/bid_optimizations/bids_60_days/__init__.py`
- `business/bid_optimizations/bids_60_days/orchestrator.py`
- `business/bid_optimizations/bids_60_days/constants.py`
- `config/optimization_config.py`

### מה תראי בסוף השלב:
- תיקייה חדשה `bids_60_days` בעץ הקבצים
- הגדרות קונפיגורציה חדשות (אבל עדיין לא פעילות בממשק)

**תוצאה רצויה:** המערכת מכירה את האופטימיזציה החדשה אך היא עדיין לא זמינה למשתמש.

---

## שלב 2: ניקוי נתונים
**מטרה:** סינון השורות הרלוונטיות והסרת נתונים לא תקינים או מוחרגים.

### קבצים לכתיבה:
- `business/bid_optimizations/bids_60_days/cleaner.py`

### מה תראי בסוף השלב:
- אין שינוי ויזואלי (לוגיקה פנימית בלבד)

**תוצאה רצויה:** רק שורות העומדות בתנאי הסינון (units > 0, לא ברשימת Delete for 60 ותנאים נוספים) יעברו לעיבוד.

---

## שלב 3: עיבוד חישובים
**מטרה:** מימוש הלוגיקה העסקית המלאה של חישוב Bid חדש לפי 7 השלבים.

### קבצים לכתיבה:
- `business/bid_optimizations/bids_60_days/processor.py`

### מה תראי בסוף השלב:
- אין שינוי ויזואלי (לוגיקה פנימית בלבד)

**תוצאה רצויה:** המערכת מחשבת Bid חדש לכל שורה וכן יוצרת גיליון "For Harvesting" לשורות ללא Target CPA.

---

## שלב 4: ממשק משתמש
**מטרה:** הוספת האופטימיזציה לממשק המשתמש והפעלת כפתור Bulk 60.

### קבצים לעדכון:
- `app/ui/components/checklist.py`
- `app/ui/shared/upload_section.py`

### מה תראי בסוף השלב:
- ✅ Checkbox חדש "Bids 60 Days" ברשימת האופטימיזציות
- ✅ כפתור "Upload Bulk 60" הופך לפעיל אחרי שבוחרים בצ'קבוקס Bids 60 Days
- ✅ הודעות ולידציה מותאמות ל-60 Days
- ✅ בחירת checkbox מפעילה/משביתה כפתורי העלאה מתאימים

**תוצאה רצויה:** המשתמש יכול לבחור את האופטימיזציה החדשה ולהעלות קובץ Bulk 60.

---

## שלב 5: ניהול מצב
**מטרה:** שמירת נתוני Bulk 60 במצב הסשן לשימוש בעיבוד.

### קבצים לעדכון:
- `app/state/bid_state.py`

### מה תראי בסוף השלב:
- ✅ שמירת קובץ Bulk 60 במצב הסשן (בשדה bulk_60_bids להבדיל מ-bulk_60 של Zero Sales)
- ✅ הודעת אישור "Bulk 60 uploaded successfully" אחרי העלאה
- ✅ **ניקוי אוטומטי של נתוני Bulk קודמים בעת החלפת אופטימיזציה**

**תוצאה רצויה:** המערכת זוכרת את הקובץ שהועלה ומוכנה לעבד אותו. **בעת החלפת אופטימיזציה, נתוני הקבצים הקודמים נמחקים מהסשן.**

---

## שלב 6: פורמט פלט
**מטרה:** הכנת הפלט עם הגיליונות החדשים וסימון השורות הבעייתיות.

### קבצים לכתיבה:
- `business/bid_optimizations/bids_60_days/output_formatter_60_days.py`

### מה תראי בסוף השלב:
- אין שינוי ויזואלי (הכנה לפלט בלבד)

**תוצאה רצויה:** המערכת יודעת לפרמט את התוצאות כולל גיליון "For Harvesting" וצביעת שורות.

---

## שלב 7: אינטגרציה ראשית
**מטרה:** חיבור כל החלקים והפעלת האופטימיזציה המלאה מקצה לקצה.

### קבצים לעדכון:
- `app/pages/bid_optimizer.py`

### מה תראי בסוף השלב:
- ✅ עיבוד מלא כשבוחרים "Bids 60 Days" ולוחצים "Process Files"
- ✅ גיליון נוסף "For Harvesting" בקובץ הפלט
- ✅ שורות מסומנות בוורוד (CVR < 8%, שגיאות, Bid מחוץ לטווח)
- ✅ הודעות סטטוס: "[X] rows with CVR < 8%", "[Y] errored rows"
- ✅ 10 עמודות עזר חדשות (calc3, Temp Bid, Max_Bid וכו')
- ✅ כותרות עמודות בתכלת לעמודות משתתפות בעיבוד

**תוצאה רצויה:** אופטימיזציית Bids 60 Days עובדת במלואה ומייצרת קובץ Excel עם כל התוצאות הנדרשות.

---

## הערה חשובה - סיכום וולידציה
**לאורך כל תהליך הפיתוח, אין צורך בכתיבה או שינוי של אף קובץ וולידציה. קבצי הוולידציה הגלובליים הקיימים במערכת מספיקים ומטפלים בכל הוולידציות הנדרשות לאופטימיזציית Bids 60 Days.**